{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Cube4\\\\Desktop\\\\project2Local\\\\Projekti2\\\\fullstack\\\\frontend\\\\src\\\\Store.js\";\nimport React, { Component } from 'react';\n\nclass Store extends Component {\n  constructor(props) {\n    super(props); //this.buy = this.buy.bind(this)\n    //this.cartInit = this.cartInit(this)\n\n    this.add = this.add.bind(this);\n    this.cart = {\n      shoppingcart: []\n    };\n    this.cartInit();\n    this.state = {\n      products: []\n    };\n    this.url = \"http://localhost:8080/products/\";\n  }\n\n  componentDidMount() {\n    fetch(this.url).then(r => r.json()).then(products => {\n      this.setState({\n        products\n      });\n    });\n  }\n\n  cartInit() {\n    if (\"shoppingCart\" in localStorage) {\n      let retrievedData = localStorage.getItem(\"shoppingCart\");\n      console.log(retrievedData);\n\n      if (retrievedData === 'undefined') {\n        localStorage.setItem(\"shoppingCart\", JSON.stringify(this.cart.shoppingcart));\n      } else {\n        var dataToArray = JSON.parse(retrievedData);\n\n        if (dataToArray != null) {\n          for (let x = 0; x < dataToArray.length; x++) {\n            this.cart.shoppingcart.push(dataToArray[x]);\n          }\n        }\n      }\n    }\n  }\n\n  buy(product) {\n    let length = this.cart.shoppingcart.length;\n    console.log(this.cart);\n    console.log(length);\n    let newItem = 0;\n    let tmpObj = this.cart.shoppingcart;\n\n    for (let x = 0; x < length; x++) {\n      if (tmpObj[x].id === product.id) {\n        tmpObj[x].qty++;\n        tmpObj[x].price += product.price;\n        newItem++;\n      }\n    }\n\n    if (newItem === 0) {\n      product.qty = 1;\n      tmpObj.push(product);\n    }\n\n    this.setState({\n      shoppingcart: tmpObj\n    });\n    console.log(tmpObj);\n    localStorage.setItem(\"shoppingCart\", JSON.stringify(this.state.shoppingcart));\n  }\n\n  add(id) {\n    let cart = this.state.shoppingcart;\n    let found = cart.find(product => product.id === id);\n    found.qty += 1;\n    this.setState({\n      shoppingcart: cart\n    });\n  }\n\n  remove(id) {\n    let cart = this.state.shoppingcart;\n    let found = cart.find(product => product.id === id);\n    found.qty -= 1;\n    this.setState({\n      shoppingcart: cart\n    });\n  }\n\n  render() {\n    let items = this.state.products.map(product => /*#__PURE__*/React.createElement(\"tr\", {\n      key: product.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }\n    }, product.id), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }\n    }, product.name), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 17\n      }\n    }, product.price), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }\n    }, product.stock), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-primary\",\n      onClick: () => {\n        let tmp = {\n          id: product.id,\n          name: product.name,\n          price: product.price\n        };\n        this.buy(tmp);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 21\n      }\n    }, \"Lis\\xE4\\xE4 ostoskoriin\"))));\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"mt-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }\n    }, \"K\\xE4ytettyjen tavaroiden opiskelijaverkkokauppa\"), /*#__PURE__*/React.createElement(\"h5\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }\n    }, \"Tavarat\"), /*#__PURE__*/React.createElement(\"table\", {\n      className: \"table\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 25\n      }\n    }, \"#\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 25\n      }\n    }, \"Nimi\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 25\n      }\n    }, \"Hinta\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 25\n      }\n    }, \"Varastossa\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 25\n      }\n    }, \"Toiminto\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 21\n      }\n    }, items)));\n  }\n\n}\n\nexport default Store;","map":{"version":3,"sources":["C:/Users/Cube4/Desktop/project2Local/Projekti2/fullstack/frontend/src/Store.js"],"names":["React","Component","Store","constructor","props","add","bind","cart","shoppingcart","cartInit","state","products","url","componentDidMount","fetch","then","r","json","setState","localStorage","retrievedData","getItem","console","log","setItem","JSON","stringify","dataToArray","parse","x","length","push","buy","product","newItem","tmpObj","id","qty","price","found","find","remove","render","items","map","name","stock","tmp"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\n\r\nclass Store extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n\r\n        //this.buy = this.buy.bind(this)\r\n        //this.cartInit = this.cartInit(this)\r\n        this.add = this.add.bind(this)\r\n\r\n        this.cart = {shoppingcart: []}\r\n        this.cartInit()\r\n        \r\n\r\n\r\n        this.state = {products: []}\r\n        this.url = \"http://localhost:8080/products/\" \r\n    }\r\n    componentDidMount() {\r\n        fetch(this.url).then(r => r.json()).then((products) => {\r\n        this.setState({products})\r\n    })\r\n    }\r\n    cartInit() {\r\n        if (\"shoppingCart\" in localStorage) {\r\n            let retrievedData = localStorage.getItem(\"shoppingCart\");\r\n            console.log(retrievedData)\r\n      \r\n            if (retrievedData === 'undefined') {\r\n                localStorage.setItem(\"shoppingCart\", JSON.stringify(this.cart.shoppingcart));\r\n            } else {\r\n                var dataToArray = JSON.parse(retrievedData);\r\n            \r\n                if (dataToArray != null) {\r\n                    for (let x = 0; x < dataToArray.length; x++) {\r\n                    this.cart.shoppingcart.push(dataToArray[x])\r\n                    }\r\n                }\r\n            }\r\n        } \r\n      }\r\n    buy(product) {    \r\n        let length = this.cart.shoppingcart.length\r\n        console.log(this.cart)\r\n        console.log(length)\r\n        let newItem = 0;\r\n        let tmpObj = this.cart.shoppingcart\r\n        for (let x = 0; x < length; x++) {\r\n          if (tmpObj[x].id === product.id) {\r\n            tmpObj[x].qty++\r\n            tmpObj[x].price += product.price\r\n            newItem++;\r\n          }\r\n        }    \r\n        if (newItem === 0) {\r\n          product.qty = 1\r\n          tmpObj.push(product)\r\n        }\r\n        this.setState({shoppingcart: tmpObj})\r\n        console.log(tmpObj)\r\n        localStorage.setItem(\"shoppingCart\", JSON.stringify(this.state.shoppingcart));\r\n    }\r\n    add(id) {\r\n        let cart = this.state.shoppingcart\r\n        let found = cart.find(product => product.id === id)\r\n        found.qty += 1\r\n        this.setState({shoppingcart: cart})\r\n      }\r\n    remove(id) {\r\n        let cart = this.state.shoppingcart\r\n        let found = cart.find(product => product.id === id)\r\n        found.qty -= 1\r\n        this.setState({shoppingcart: cart})\r\n    }\r\n    render() {        \r\n        let items = this.state.products.map((product) => \r\n            <tr key={product.id}>\r\n                <td>{product.id}</td>\r\n                <td>{product.name}</td>\r\n                <td>{product.price}</td>\r\n                <td>{product.stock}</td>\r\n                <td>\r\n                    <button type=\"button\" className=\"btn btn-primary\" onClick={() => { \r\n                        let tmp = {id: product.id,\r\n                                name: product.name, \r\n                                price: product.price}\r\n                        this.buy(tmp)}}>\r\n                        Lisää ostoskoriin\r\n                    </button>\r\n                </td>\r\n            </tr>)\r\n        return (\r\n            <div className=\"container\">\r\n                <h1 className=\"mt-5\">Käytettyjen tavaroiden opiskelijaverkkokauppa</h1>\r\n                <h5>Tavarat</h5>\r\n                <table className=\"table\">\r\n                    <thead>\r\n                        <tr>\r\n                        <th scope=\"col\">#</th>\r\n                        <th scope=\"col\">Nimi</th>\r\n                        <th scope=\"col\">Hinta</th>\r\n                        <th scope=\"col\">Varastossa</th>\r\n                        <th scope=\"col\">Toiminto</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {items}\r\n                    </tbody>\r\n                </table>  \r\n            </div>\r\n        )  \r\n    }\r\n}\r\n\r\nexport default Store"]},"metadata":{},"sourceType":"module"}